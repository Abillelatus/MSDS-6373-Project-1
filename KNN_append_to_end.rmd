### Objective 2
We're going to try out a KNN model for Objective 2.  
```{r}
library(caret)
#I'm using the output from the split below but renaming to help differentiate in the knn model to prevent confusion from here and there
#Converting the factors to numeric on the level to prevent NAs by coercion in Knn.
life_exp_train_v06_final$Year <- as.numeric(as.integer(factor(life_exp_train_v06_final$Year)))
life_exp_train_v06_final$Status <- as.numeric(as.integer(factor(life_exp_train_v06_final$Status)))
life_exp_test$Year <- as.numeric(as.integer(factor(life_exp_test$Year)))
life_exp_test$Status <- as.numeric(as.integer(factor(life_exp_test$Status)))

train_pred <- subset(life_exp_train_v06_final, select=c(-Life.expectancy))
train_out <- life_exp_train_v06_final$Life.expectancy
test_pred <- subset(life_exp_test, select=c(-Life.expectancy))
test_out <- life_exp_test$Life.expectancy
#train a knn model
le.knn <- knnreg(train_pred, train_out)
#predict the test life expectancy
predicted_test <- predict(le.knn, data.frame(test_pred))
#output the MSE, MAE, and RMSE
cat("MSE: ", mean((test_out - predicted_test)^2), " MAE: ", caret::MAE(test_out, predicted_test), " RMSE: ", caret::RMSE(test_out, predicted_test))
#create a plot of the results of the knn model.
x_value <- 1:length(test_out)
plot(x_value, test_out, col="Green", type="l", lwd=1, main="Predicted Life Expectancy", xlab="", ylab="Age")
lines(x_value, predicted_test, col="Orange", lwd=1)
legend("topleft", legend=c("Original Life Exp.", "Predicted Life Exp"), fill = c("Green", "Orange"), col=2:3, adj=c(0,0.5))
grid()
```
